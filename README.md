# Hikvision_dashcam_format

海康威视C6 Pro+行车记录仪文件格式分析

## 文档结构

本文档介绍SD卡中存储的各种文件的格式。主要结构如下：
- [SD卡根目录](./doc/SD_card.md)
  - [index文件](./doc/index.md)
  - [mp4文件](./doc/hiv_mp4.md)
    - [视频文件](./doc/hiv_mp4_video.md)
        - [视频文件额外信息](./doc/private_stream_1.md)
    - [抓拍文件](./doc/hiv_mp4_photo.md)
  - [log文件](./doc/log.md)

推荐从[SD卡根目录](./doc/SD_card.md)开始按顺序浏览。

## 其他说明

### 行车记录仪内部时区

当手机APP连接行车记录仪时，会同步给行车记录仪时区信息。同步的时区为**不实行夏令时**的手机时区。

例如手机设置为美洲西部**夏令时间**，则行车记录仪中会被同步美洲西部**标准时间**。当美洲西部夏令时晚上20时34分发生某事件时，行车记录仪内部会被记录为晚上19时34分。当设置为北京时间时，不会出现夏令时的问题。

行车记录仪内部的所有活动都将使用此时区，包括但不限于：内部时钟、文件创建/修改时间、视频水印、GPS轨迹等。

### 时间戳

行车记录仪内部会**将当前本地时间当作UTC转化成时间戳**。即，行车记录仪在转换时间戳时总是把本地时间**当作**是UTC。这与UNIX时间戳不同。

例如，行车记录仪的时区设为UTC-1时区，时间设为1970年1月1日0时0分1秒。此时，UTC应为1970年1月1日0时1分1秒，UNIX时间戳将为`3601`。但行车记录仪在转化时间戳会将其直接理解为UTC+0的1970年1月1日0时0分1秒，因此行车记录仪生成的时间戳将为`1`。

除非特殊说明，文档中所有的“时间戳”都指的是上述这种时间戳。

### 文件保存时间

存储卡使用FAT32文件系统，该文件系统无法保存时区信息。因此所有文件的保存时间都为行车记录仪内部时区的时间。

### 端序

除非特别声明，文档中所有多字节变量都为小端序（Little-endian），低地址存储变量低字节。
